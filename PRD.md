# Markdown 笔记应用 - 产品需求文档 (PRD)

## 1. 引言

### 1.1 项目名称
Markdown 笔记应用 (MarkNote)

### 1.2 项目背景
为了满足用户对轻量级、离线可用的 Markdown 笔记工具的需求，本项目旨在开发一个基于浏览器的纯前端笔记应用。用户可以在一个简洁的界面中编写 Markdown 内容，并实时预览渲染效果。应用将充分利用现代 Web 技术（如 LocalStorage、IndexedDB）实现数据的本地持久化，并提供丰富的增强功能，如代码高亮、图片上传、目录导航、PDF 导出、主题切换等，以提升写作和阅读体验。

### 1.3 目标用户
- 习惯使用 Markdown 进行写作的技术人员、学生、博主。
- 需要离线记录笔记且注重隐私的用户。
- 喜欢简洁、可定制化界面的知识工作者。

## 2. 总体描述

### 2.1 产品概述
MarkNote 是一个单页应用（SPA），提供左右分栏的编辑与预览界面。左侧包含笔记列表（支持搜索）和 Markdown 编辑器；右侧实时显示渲染后的 HTML 效果。所有笔记数据保存在浏览器的 LocalStorage 中（图片资源使用 IndexedDB 或 DataURL 存储），支持笔记的增删改查。应用将集成代码高亮、图片上传、自动生成目录、导出 PDF、多主题和多 Markdown 风格等功能。

### 2.2 用户界面概述
- **布局**：左右两栏布局，左侧宽度略大于右侧或可调节。
- **左侧区域**：顶部为搜索框；下方为笔记列表（按最后修改时间倒序）；列表下方为“新建笔记”按钮；笔记列表下方或右侧为编辑器区域（当选中笔记时显示）。
- **右侧区域**：实时预览区域，顶部可能包含目录导航按钮或主题切换控件。
- **整体风格**：简洁、现代化，支持明暗主题切换。

## 3. 功能需求

### 3.1 笔记管理

#### 3.1.1 笔记列表
- 以列表形式展示所有笔记，显示标题、最后修改时间（或摘要）。
- 默认按最后修改时间倒序排列。
- 点击列表项可在编辑区加载该笔记内容。

#### 3.1.2 搜索笔记
- 在左侧顶部的搜索框中输入关键词，实时过滤笔记列表（匹配标题或内容）。
- 支持大小写不敏感搜索。

#### 3.1.3 创建新笔记
- 点击“新建笔记”按钮，自动生成一个默认标题（如“无标题笔记”），清空编辑器，并将焦点置于编辑器。
- 新笔记自动保存到列表。

#### 3.1.4 编辑笔记
- 在编辑器区域修改标题（单独标题输入框）和内容（Markdown 正文）。
- 修改后自动保存（防抖处理，如延迟 1 秒）到 LocalStorage。

#### 3.1.5 删除笔记
- 每个笔记列表项旁提供删除图标，点击后弹出确认框，确认后删除笔记。
- 删除后自动切换到下一个笔记或新建笔记。

### 3.2 编辑与预览

#### 3.2.1 实时预览
- 右侧预览区域随左侧编辑区内容变化实时更新（防抖，避免高频渲染）。
- 预览区域应正确渲染 Markdown 语法，包括标题、列表、表格、链接、图片等。

#### 3.2.2 Markdown 语法支持
- 支持标准 Markdown 语法（CommonMark）。
- 支持 GitHub Flavored Markdown（GFM）扩展，如任务列表、删除线、表格等。

#### 3.2.3 代码块语法高亮
- 支持常见编程语言（JavaScript、Python、Java、C++、HTML、CSS 等）的语法高亮。
- 代码块应显示语言标识，并提供复制代码按钮（可选）。

### 3.3 图片上传
- 编辑器区域提供图片上传按钮（或支持拖拽、粘贴上传）。
- 用户可选择本地图片，插入到当前光标位置。
- 图片存储方式：
  - 小图片可转换为 Base64 DataURL 嵌入 Markdown。
  - 大图片应保存到 IndexedDB 并生成 Blob URL 引用，避免 LocalStorage 大小限制。
- 预览区域应能正确显示图片。

### 3.4 目录导航
- 自动根据 Markdown 中的标题（h1-h6）生成文章大纲。
- 目录可悬浮在预览区域右上角，或作为独立侧边栏（可折叠）。
- 点击目录项，平滑滚动到预览区域的对应标题位置。

### 3.5 导出 PDF
- 提供“导出 PDF”按钮，将当前笔记的预览内容导出为 PDF 文件。
- 导出时应保留样式（代码高亮、字体等），并支持分页。
- 实现方式：使用浏览器打印功能（`window.print()`）配合打印样式，或利用 `html2pdf` 库。

### 3.6 主题切换
- 提供至少两种主题：浅色主题和深色主题（或更多，如 Sepia）。
- 主题切换应同时影响编辑器、预览区和整体界面。
- 编辑器本身可使用不同的代码编辑器主题（如 Material, Monokai 等）。

### 3.7 Markdown 风格切换
- 提供下拉菜单，允许用户选择不同的渲染风格：
  - **标准风格**：基于默认的 Markdown 样式。
  - **GitHub 风格**：使用 GitHub Markdown 样式（如 `github-markdown-css`）。
  - **自定义风格**（可选）：未来可扩展。
- 切换风格应实时更新预览区域的样式。

## 4. 非功能性需求

### 4.1 性能
- 应用启动时间 < 2 秒（基于现代浏览器）。
- 笔记切换、搜索、预览更新无明显延迟（< 100ms）。
- 图片上传不应阻塞 UI，使用异步处理。

### 4.2 数据持久化
- 笔记数据永久保存在 LocalStorage，应用关闭后重新打开数据应完整恢复。
- 图片数据若使用 IndexedDB，应保证在存储限制内正常运行。
- 提供数据导出/导入功能（可选，但推荐）。

### 4.3 兼容性
- 支持最新版 Chrome、Firefox、Edge、Safari。
- 移动端浏览器基本可用（但主要针对桌面优化）。

### 4.4 可访问性
- 遵循基本的 WCAG 2.1 标准，如语义化 HTML、键盘导航。
- 为交互元素提供 ARIA 标签。

### 4.5 安全性
- 对用户输入内容进行安全转义，防止 XSS 攻击（Markdown 渲染库默认会做过滤）。
- 图片上传仅限图片类型，避免上传危险文件。

## 5. 约束与假设

- 应用完全在客户端运行，无服务器端组件。
- 假设用户使用现代浏览器且允许 JavaScript 执行。
- 图片存储受浏览器存储配额限制（通常为几百 MB），应用应在存储接近上限时给出警告。

## 6. 附录：界面原型描述
