# AI 代理指令 - 辅助开发 (简化版)

## 1. 项目目标
构建一个离线可用的 Markdown 笔记应用，具备实时预览、图片上传、目录导航、PDF 导出、主题切换和多风格渲染功能。

## 2. 开发环境
- 使用 Vite + React + TypeScript 模板初始化。
- 安装核心依赖：`marked`、`marked-gfm`、`highlight.js`、`idb`。
- 推荐编辑器组件：`@uiw/react-textarea-code-editor`。

## 3. 开发任务顺序
请按以下顺序逐步实现功能，每步完成后进行基本测试：

1. **基础框架**：搭建左右分栏布局，包含侧边栏、编辑器区域、预览区域占位。
2. **数据存储**：实现 LocalStorage 读写（笔记列表），定义 Note 类型；封装 IndexedDB 用于图片存储。
3. **笔记列表与搜索**：创建 Context 管理笔记状态，展示笔记列表，添加搜索框实时过滤。
4. **编辑器组件**：集成编辑器，支持标题和正文编辑，内容变化时自动保存（防抖）。
5. **预览组件**：使用 `marked` + `highlight.js` 渲染 Markdown，实现实时预览。
6. **图片上传**：添加上传按钮，处理图片存储并插入 Markdown，预览区能正常显示。
7. **目录导航**：提取标题生成大纲，点击平滑滚动到对应位置。
8. **PDF 导出**：实现导出按钮，利用浏览器打印生成 PDF。
9. **主题切换**：通过 CSS 变量实现浅色/深色主题切换。
10. **Markdown 风格切换**：添加下拉选择，切换预览样式（如 GitHub 风格 vs 标准风格）。

## 4. 开发原则
- 使用 TypeScript 严格模式，为所有 props 和 state 定义类型。
- 组件采用函数组件 + Hooks，通用逻辑抽取为自定义 Hook。
- 样式使用 CSS Modules 或 CSS 变量，确保主题可切换。
- 保持代码简洁，注重功能完整性，后续可优化。

## 5. 注意事项
- LocalStorage 容量有限（约 5-10MB），大图片建议存入 IndexedDB。
- Markdown 渲染时注意 XSS 防护（`marked` 默认已做转义）。
- 图片上传后，及时清理不再使用的 Blob URL 避免内存泄漏。
- 实时预览和保存使用防抖（建议 500ms）提升性能。